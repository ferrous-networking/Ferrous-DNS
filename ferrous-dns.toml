[server]
dns_port = 53
web_port = 8080
bind_address = "0.0.0.0"

[dns]
upstream_servers = []
query_timeout = 5
cache_enabled = true
cache_ttl = 7200
dnssec_enabled = true
default_strategy = "Parallel"
cache_max_entries = 200000
cache_eviction_strategy = "hit_rate"
cache_optimistic_refresh = true
cache_min_hit_rate = 2.0
cache_min_frequency = 10
cache_min_lfuk_score = 1.5
cache_refresh_threshold = 0.75
cache_lfuk_history_size = 10
cache_batch_eviction_percentage = 0.1
cache_compaction_interval = 600
cache_adaptive_thresholds = false
# Número de shards internos do cache (DashMap).
# Quando omitido, é detectado automaticamente: 4× cores da CPU arredondado
# para potência de 2 (RPi 4 → 16, servidor 8 cores → 32, 16 cores → 64).
# Descomente apenas se quiser forçar um valor específico:
# cache_shard_amount = 64
block_private_ptr = true
block_non_fqdn = true
local_domain = "lan"

[[dns.pools]]
name = "cloudflare"
strategy = "Parallel"
priority = 1
servers = [
    "tls://1.1.1.1:853",
    "tls://1.0.0.1:853",
]

[dns.health_check]
interval = 30
timeout = 2000
failure_threshold = 3
success_threshold = 2

[[dns.conditional_forwarding]]
domain = "lan"
server = "10.0.0.1:53"

[[dns.local_records]]
hostname = "viudes"
domain = "local"
ip = "10.0.10.1"
record_type = "A"
ttl = 300

[blocking]
enabled = true
custom_blocked = []
whitelist = []

[logging]
level = "info"

[database]
path = "ferrous-dns.db"
log_queries = true
queries_log_stored = 30
# Minimum seconds between consecutive last-seen DB writes for the same client IP.
# Reduce to track clients more frequently; increase to lower SQLite write pressure.
client_tracking_interval = 60
